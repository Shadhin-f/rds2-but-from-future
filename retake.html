<!DOCTYPE html>
<html lang="en">
  <head>
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5572277246422121"
      crossorigin="anonymous"
    ></script>
    <meta name="google-adsense-account" content="ca-pub-5572277246422121" />
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-DR0D2D6C35"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-DR0D2D6C35");
    </script>
    <link rel="icon" type="image/png" sizes="32x32" href="images/index.png" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NSU Retake Calculator</title>
    <link rel="stylesheet" href="styles.css?v=1.1" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      main {
        display: flex;
        flex-direction: column;
        gap: 2rem;
        padding-bottom: 2.5rem;
        max-width: 960px;
        margin: 0 auto;
        width: 100%;
      }
      .calculator-hero {
        text-align: center;
        margin-top: 1.5rem;
        margin-bottom: 0.5rem;
      }
      .calculator-hero h1 {
        font-size: clamp(2rem, 4vw, 2.6rem);
        margin-bottom: 0.5rem;
      }
      .calculator-hero p {
        color: var(--text-muted);
        max-width: 640px;
        margin: 0 auto 2rem;
        line-height: 1.5;
      }
      .calc-card {
        background: rgba(15, 23, 42, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 18px;
        padding: 1.75rem 1.5rem;
        box-shadow: 0 18px 40px rgba(0, 0, 0, 0.25);
        width: 100%;
      }
      .calc-card h2 {
        margin-top: 0;
        margin-bottom: 1rem;
        font-size: 1.2rem;
      }
      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1rem;
      }
      .form-control,
      select.form-control {
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
        background: rgba(15, 23, 42, 0.9);
        border: 1px solid rgba(148, 163, 184, 0.35);
        border-radius: 10px;
        color: #f8fafc;
        padding: 0.85rem 1rem;
        font-size: 1rem;
      }
      .form-control:focus,
      select.form-control:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(109, 40, 217, 0.25);
      }
      table.cgpa-table {
        width: 100%;
        min-width: 560px;
        border-collapse: collapse;
        table-layout: fixed;
      }
      table.cgpa-table th,
      table.cgpa-table td {
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        vertical-align: middle;
      }
      table.cgpa-table th {
        text-align: left;
        padding: 0.8rem 0.5rem;
        font-weight: 600;
        color: var(--text-muted);
        white-space: nowrap;
      }
      table.cgpa-table th:nth-child(1) { width: 26%; }
      table.cgpa-table th:nth-child(2) { width: 14%; }
      table.cgpa-table th:nth-child(3) { width: 20%; }
      table.cgpa-table th:nth-child(4) { width: 20%; }
      table.cgpa-table th:nth-child(5) { width: 20%; }
      table.cgpa-table td {
        padding: 0.6rem 0.5rem;
      }
      table.cgpa-table td .form-control,
      table.cgpa-table td select.form-control {
        width: 100%;
        min-width: 0;
      }
      .courses-wrapper {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
      .courses-wrapper::-webkit-scrollbar {
        height: 6px;
      }
      .courses-wrapper::-webkit-scrollbar-thumb {
        background: rgba(148, 163, 184, 0.3);
        border-radius: 3px;
      }
      .actions-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
        margin-top: 1.75rem;
      }
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.35rem;
        border-radius: 10px;
        border: 1px solid transparent;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        padding: 0.85rem 1.4rem;
      }
      .btn:hover {
        transform: translateY(-1px);
      }
      .btn-outline {
        background: transparent;
        border-color: #22c55e;
        color: #22c55e;
      }
      .btn-outline:hover {
        box-shadow: 0 0 12px rgba(34, 197, 94, 0.5);
      }
      .btn-primary {
        background: #22c55e;
        color: #0f172a;
      }
      .btn-primary:hover {
        box-shadow: 0 12px 32px rgba(34, 197, 94, 0.25);
      }
      .results-panel {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1rem;
        margin-top: 2rem;
        width: 100%;
      }
      .result-box {
        border-radius: 12px;
        padding: 1.2rem 1.6rem;
        background: rgba(15, 23, 42, 0.85);
        border: 1px solid rgba(148, 163, 184, 0.2);
      }
      .result-box.highlight {
        background: linear-gradient(135deg, #22c55e, #16a34a);
        color: #0f172a;
        border: none;
      }
      .result-box span {
        display: block;
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        margin-bottom: 0.6rem;
        color: rgba(248, 250, 252, 0.8);
      }
      .result-box h3 {
        margin: 0;
        font-size: 2rem;
        font-weight: 700;
      }
      .result-box.highlight span,
      .result-box.highlight h3 {
        color: #042f1a;
      }
      .result-box.highlight h3 {
        font-size: 2.4rem;
      }
      .calc-message {
        margin-top: 1rem;
        color: #fb7185;
        min-height: 1.2rem;
      }
      .remove-course {
        border: none;
        border-radius: 999px;
        width: 40px;
        height: 40px;
        background: rgba(248, 250, 252, 0.08);
        color: #f87171;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s ease, transform 0.2s ease;
      }
      .remove-course:hover {
        background: rgba(248, 113, 113, 0.15);
        transform: translateY(-1px);
      }
      .course-row:last-child td {
        border-bottom: none;
      }
      @media (max-width: 720px) {
        .calc-card {
          padding: 1rem 0.75rem;
        }
        .form-grid {
          grid-template-columns: 1fr;
        }
        .actions-row {
          flex-direction: column;
          align-items: stretch;
        }
        .btn {
          width: 100%;
        }
        .results-panel {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <canvas id="particleCanvas"></canvas>
    <div class="container">
      <header>
        <h1>NSU Retake Calculator</h1>
        <nav class="nav-bar">
          <a href="index.html">RDS2</a>
          <a href="calendar.html">Academic Calendar</a>
          <a href="resources.html" class="trending-link">Study Materials</a>
          <a href="routine.html">Routine Maker</a>
          <a href="planner.html">Semester Planner</a>
          <a href="freshman.html">Freshman Guides</a>
          <a href="coursemap.html">Course map</a>
          <a href="booksearch.html">NSU Library Book Locator</a>
          <a href="shelf_search.html">Library Shelf Finder</a>
          <a href="cgpa.html">CGPA Calculator</a>
          <a href="retake.html" class="active">Retake Calculator</a>
          <a href="about.html">About Dev</a>
        </nav>
      </header>

      <main>
        <section class="calculator-hero">
          <p>
            Plan your retakes smartly. Enter your current credits &amp; CGPA, then add the courses you plan to retake with previous and expected grades. See how your CGPA will change after the retakes.
          </p>
        </section>

        <section class="calc-card">
          <h2>Current Summary</h2>
          <div class="form-grid">
            <div>
              <label for="prevCr">Credits Completed</label>
              <input
                type="number"
                min="0"
                step="0.5"
                id="prevCr"
                class="form-control"
                placeholder="e.g., 90"
              />
            </div>
            <div>
              <label for="prevCg">Current CGPA</label>
              <input
                type="number"
                min="0"
                max="4"
                step="0.01"
                id="prevCg"
                class="form-control"
                placeholder="e.g., 2.85"
              />
            </div>
          </div>
        </section>

        <section class="calc-card">
          <h2>Retake Courses</h2>
          <div class="courses-wrapper">
            <table class="cgpa-table">
              <thead>
                <tr>
                  <th>Course (opt)</th>
                  <th>Credits</th>
                  <th>Prev Grade</th>
                  <th>Expected</th>
                  <th style="width: 60px">Remove</th>
                </tr>
              </thead>
              <tbody id="courseRows"></tbody>
            </table>
          </div>
          <div class="actions-row">
            <button id="addCourse" class="btn btn-outline">
              <i class="fas fa-plus"></i> Add Retake
            </button>
            <div style="flex: 1"></div>
            <button id="calculateBtn" class="btn btn-primary">
              <i class="fas fa-calculator"></i> Calculate
            </button>
          </div>
          <div id="calcMessage" class="calc-message"></div>
        </section>

        <div class="results-panel">
          <div class="result-box">
            <span>Credits (unchanged)</span>
            <h3 id="creditDisplay">0.00</h3>
          </div>
          <div class="result-box highlight">
            <span>Projected CGPA</span>
            <h3 id="cgpaValue">0.00</h3>
          </div>
        </div>
      </main>

      <footer class="footer">
        <p>
          © 2025 RDS2 BUT FROM FUTURE · Created by Tahshan Jamil Shadhin
          <br />
        </p>
        <div class="social-links">
          <span>Follow me on</span>
          <a
            href="https://www.facebook.com/share/19DGPCk2wr/"
            target="_blank"
            title="Facebook"
          >
            <i class="fab fa-facebook"></i>
          </a>
          <a
            href="https://www.instagram.com/_shadhin_f"
            target="_blank"
            title="Instagram"
          >
            <i class="fab fa-instagram"></i>
          </a>
          <a
            href="https://www.linkedin.com/in/tahshan-jamil-shadhin?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app"
            target="_blank"
            title="LinkedIn"
          >
            <i class="fab fa-linkedin"></i>
          </a>
        </div>
        <br />
        Last updated: 04-01-2026
      </footer>
    </div>

    <script>
      const gradePoints = {
        "A": 4.0,
        "A-": 3.7,
        "B+": 3.3,
        "B": 3.0,
        "B-": 2.7,
        "C+": 2.3,
        "C": 2.0,
        "C-": 1.7,
        "D+": 1.3,
        "D": 1.0,
        "F": 0,
      };

      const courseRows = document.getElementById("courseRows");
      const addCourseBtn = document.getElementById("addCourse");
      const calcBtn = document.getElementById("calculateBtn");
      const creditDisplayEl = document.getElementById("creditDisplay");
      const cgpaValueEl = document.getElementById("cgpaValue");
      const messageEl = document.getElementById("calcMessage");

      let rowCount = 0;

      function createSelect(id, defaultGrade) {
        const select = document.createElement("select");
        select.id = id;
        select.className = "form-control";
        for (const grade of Object.keys(gradePoints)) {
          const option = document.createElement("option");
          option.value = grade;
          option.textContent = grade;
          if (grade === defaultGrade) option.selected = true;
          select.appendChild(option);
        }
        return select;
      }

      function addRetakeRow() {
        rowCount += 1;
        const row = document.createElement("tr");
        row.className = "course-row";
        row.dataset.index = rowCount;
        const creditId = `cr${rowCount}`;
        const prevGradeId = `prevGr${rowCount}`;
        const expGradeId = `expGr${rowCount}`;

        row.innerHTML = `
          <td>
            <input
              type="text"
              class="form-control"
              placeholder="Course"
              maxlength="10"
            />
          </td>
          <td>
            <input
              type="number"
              min="0"
              step="0.5"
              class="form-control"
              id="${creditId}"
              placeholder="Cr"
            />
          </td>
          <td id="${prevGradeId}-cell"></td>
          <td id="${expGradeId}-cell"></td>
          <td class="remove-cell">
            <button type="button" class="remove-course" aria-label="Remove">
              <i class="fas fa-xmark"></i>
            </button>
          </td>
        `;

        courseRows.appendChild(row);
        document.getElementById(`${prevGradeId}-cell`).appendChild(createSelect(prevGradeId, "F"));
        document.getElementById(`${expGradeId}-cell`).appendChild(createSelect(expGradeId, "A"));
        row.querySelector(".remove-course").addEventListener("click", () => {
          removeRow(row);
        });
      }

      function removeRow(row) {
        if (courseRows.children.length <= 1) {
          messageEl.textContent = "At least one retake row is required.";
          return;
        }
        row.remove();
        messageEl.textContent = "Removed retake row.";
      }

      function initializeRows() {
        addRetakeRow();
      }

      function calculate() {
        const prevCredits = Number(document.getElementById("prevCr").value) || 0;
        const prevCgpa = Number(document.getElementById("prevCg").value) || 0;

        if (!prevCredits || !prevCgpa) {
          messageEl.textContent = "Please enter your current credits and CGPA.";
          creditDisplayEl.textContent = "0.00";
          cgpaValueEl.textContent = "0.00";
          return;
        }

        let totalQualityPoints = prevCredits * prevCgpa;
        let totalCredits = prevCredits;
        let hasRetake = false;

        for (let i = 1; i <= rowCount; i += 1) {
          const creditInput = document.getElementById(`cr${i}`);
          const prevGradeSelect = document.getElementById(`prevGr${i}`);
          const expGradeSelect = document.getElementById(`expGr${i}`);
          if (!creditInput || !prevGradeSelect || !expGradeSelect) continue;

          const credits = Number(creditInput.value);
          if (!credits) continue;
          hasRetake = true;

          const prevPoint = gradePoints[prevGradeSelect.value] ?? 0;
          const expPoint = gradePoints[expGradeSelect.value] ?? 0;

          // Remove old contribution, add new
          totalQualityPoints -= credits * prevPoint;
          totalQualityPoints += credits * expPoint;
        }

        if (!hasRetake) {
          messageEl.textContent = "Add at least one retake course with credits.";
          creditDisplayEl.textContent = prevCredits.toFixed(2);
          cgpaValueEl.textContent = prevCgpa.toFixed(2);
          return;
        }

        const newCgpa = totalQualityPoints / totalCredits;
        messageEl.textContent = "Projected CGPA calculated successfully.";
        creditDisplayEl.textContent = totalCredits.toFixed(2);
        cgpaValueEl.textContent = newCgpa.toFixed(2);
      }

      addCourseBtn.addEventListener("click", () => {
        addRetakeRow();
        messageEl.textContent = "Added a new retake row.";
      });

      calcBtn.addEventListener("click", calculate);

      initializeRows();
    </script>
    <script src="script.js"></script>
    <script src="buttons.js"></script>
  </body>
</html>
